# Copyright (c) Ultraviolet
# SPDX-License-Identifier: Apache-2.0
#
# Cloud Docker Compose Profile
# This file contains only cloud-specific services.
# All other services (SuperMQ, Cube, etc.) come from included compose files.

services:
  # ===== Cloud Traefik Reverse Proxy =====
  cloud-traefik:
    image: traefik:v3.0
    container_name: cube-cloud-traefik
    profiles: ["cloud"]
    ports:
      - "49210:80"    # HTTP (for ACME challenge and redirect to HTTPS)
      - "49211:443"   # HTTPS (main application traffic)
      - "49212:8080"  # Traefik dashboard
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ./traefik/traefik.toml:/etc/traefik/traefik.toml:ro
      - ./traefik/dynamic.toml:/etc/traefik/dynamic.toml:ro
      - ./traefik/ssl:/etc/traefik/ssl
    networks:
      - cube-network
    restart: unless-stopped
    labels:
      logging: "traefik"
      service: "proxy"
